class Solution(object):
    def maxProfit(self, prices):
        """
        :type prices: List[int]
        :rtype: int
        
        """

        # https://stackoverflow.com/questions/2474015/getting-the-index-of-the-returned-max-or-min-item-using-max-min-on-a-list 
        # Get index of min and max values
        index_min = min(range(len(prices)), key=prices.__getitem__)  
        index_max = max(range(len(prices)), key=prices.__getitem__)

        if index_min == index_max:
            return 0
        
        def low_high(prices, index_min, index_max):
            return prices[index_max] - prices[index_min]

        if index_min < index_max:
            return low_high(prices, index_min, index_max) 

        # Case 2: index max < index min, worse case
        """
        Idea: get local min from before max index --> maxprofit1
        Compare it to maxprofit2 --> 
        """
        def high_low(prices, index_min, index_max):
            len_prices = len(prices)
            local_min = min(range(index_max + 1), key=prices.__getitem__)
            # max_profit from before index max
            max_profit1 = prices[index_max] - prices[local_min]

            # Compare to max_profit after index max

            buy = index_max + 1

            for i in range (index_max + 1, len_prices):
                if prices[i] > prices[buy]:  
                    continue
                buy = i
                for j in range (i, len_prices):
                    if prices[j] < prices[i]:  # No profit
                        continue
                    else: 
                        if prices[j] - prices[i] > max_profit1:
                            max_profit1 = prices[j] - prices[i]
            return max_profit1
            
        if index_max < index_min:
            return high_low(prices, index_min, index_max)
        
        return 0
